<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Professional Weather App</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
  * { box-sizing: border-box; margin:0; padding:0; font-family:'Roboto', sans-serif; }
  body {
    display:flex; flex-direction:column; align-items:center;
    min-height:100vh; padding:20px; transition: background 1s ease, color 0.5s ease;
    background: linear-gradient(to right, #a1c4fd, #c2e9fb); color: #111;
  }
  header {
    font-size: 20px; font-weight:bold; margin-bottom:20px;
    color: inherit; /* adapts to dark/light mode */
    transition: color 0.5s;
  }
  .top-bar { display:flex; gap:10px; margin-bottom:20px; flex-wrap:wrap; justify-content:center; }
  input, button {
    padding:10px; font-size:16px; border-radius:5px; border:none;
  }
  button { background-color:#3B82F6; color:white; cursor:pointer; transition:0.2s; }
  button:hover { transform:scale(1.05); }
  .toggle-btn { background:#333; color:#fff; }
  #container {
    display: none; /* hide initially */
    background: rgba(255,255,255,0.9); border-radius:15px;
    padding:20px; max-width:360px; text-align:center;
    box-shadow:0 8px 25px rgba(0,0,0,0.3); transition: transform 0.3s, background 0.5s, color 0.5s;
    color: #111;
  }
  #container:hover { transform:translateY(-5px); }
  h2 { font-size:24px; margin:10px 0; }
  p { margin:5px 0; }
  img { width:80px; height:80px; }
  .forecast { display:flex; justify-content:space-between; flex-wrap:wrap; margin-top:15px; }
  .forecast-card {
    background: #f0f0f0; width:90px; margin:5px; padding:10px;
    border-radius:10px; transition: transform 0.3s, box-shadow 0.3s, background 0.5s, color 0.5s;
    text-align:center; color: #111;
  }
  .forecast-card:hover { transform:scale(1.05); box-shadow:0 5px 15px rgba(0,0,0,0.3); }
  .error { color:red; font-weight:bold; margin-top:10px; }
  
  body.dark-mode {
    background:#121212; color:#f5f5f5;
  }
  body.dark-mode #container {
    background: rgba(30,30,30,0.9); color:#f5f5f5;
  }
  body.dark-mode .forecast-card {
    background: #2a2a2a; color:#f5f5f5;
  }
  body.dark-mode .toggle-btn {
    background:#f5f5f5; color:#111;
  }

  @media (max-width:400px) { .forecast { flex-direction:column; align-items:center; } .forecast-card { width:80%; } }
</style>
</head>
<body>

<header>Made by Ruchit Tank</header>

<div class="top-bar">
  <input id="text" type="text" placeholder="Enter City Name">
  <button id="btn">Search</button>
  <button id="themeToggle" class="toggle-btn">üåô</button>
</div>

<div id="container"></div>

<script>
const textInput = document.getElementById("text");
const searchBtn = document.getElementById("btn");
const themeToggle = document.getElementById("themeToggle");
const container = document.getElementById("container");
let darkMode = false;

async function fetchWeather(city){
  container.innerHTML="";
  if(!city) { alert("Please enter a city name."); return; }
  const apiKey="ff785b71dfd84fcb6b6c14f23c502c1f";

  try {
    // Current Weather
    const res = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&appid=${apiKey}`);
    const data = await res.json();
    if(data.cod!==200){ container.style.display="block"; container.innerHTML=`<p class="error">City not found!</p>`; return; }

    container.style.display="block"; // show container now

    const cityName = document.createElement("h2");
    cityName.innerText=`${data.name}, ${data.sys.country}`;

    const temp = document.createElement("p");
    temp.innerHTML=`Temp: ${data.main.temp}¬∞C (Feels like ${data.main.feels_like}¬∞C)`;

    const desc = document.createElement("p");
    desc.innerText=`Weather: ${data.weather[0].description}`;

    const icon = document.createElement("img");
    icon.src=`http://openweathermap.org/img/wn/${data.weather[0].icon}@2x.png`;

    const humidity = document.createElement("p");
    humidity.innerText=`Humidity: ${data.main.humidity}%`;

    const wind = document.createElement("p");
    wind.innerText=`Wind: ${data.wind.speed} m/s`;

    const visibility = document.createElement("p");
    visibility.innerText=`Visibility: ${(data.visibility/1000).toFixed(1)} km`;

    const pressure = document.createElement("p");
    pressure.innerText=`Pressure: ${data.main.pressure} hPa`;

    const timezoneOffset=data.timezone/3600;
    const timezone=document.createElement("p");
    timezone.innerText=`UTC: ${timezoneOffset>=0?"+":""}${timezoneOffset}`;

    const sunrise=new Date((data.sys.sunrise + data.timezone)*1000);
    const sunset=new Date((data.sys.sunset + data.timezone)*1000);
    const sun=document.createElement("p");
    sun.innerText=`Sunrise: ${formatTime(sunrise)} | Sunset: ${formatTime(sunset)}`;

    container.append(cityName, icon, desc, temp, humidity, wind, visibility, pressure, timezone, sun);

    // Dynamic Background
    const weather=data.weather[0].main.toLowerCase();
    if(weather.includes("clear")) document.body.style.background=darkMode?"#1c1c2a":"linear-gradient(to right, #fbc2eb, #a6c1ee)";
    else if(weather.includes("cloud")) document.body.style.background=darkMode?"#2a2a38":"linear-gradient(to right, #bdc3c7, #2c3e50)";
    else if(weather.includes("rain")||weather.includes("drizzle")) document.body.style.background=darkMode?"#1e1e2a":"linear-gradient(to right, #cfd9df, #e2ebf0)";
    else if(weather.includes("snow")) document.body.style.background=darkMode?"#2a2a38":"linear-gradient(to right, #e6dada, #274046)";
    else document.body.style.background=darkMode?"#121212":"linear-gradient(to right, #a1c4fd, #c2e9fb)";

    // 3-Day Forecast
    const forecastRes=await fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${data.name}&units=metric&appid=${apiKey}`);
    const forecastData=await forecastRes.json();
    const forecastDiv=document.createElement("div"); forecastDiv.className="forecast";

    for(let i=0;i<forecastData.list.length;i+=8){
      const f=forecastData.list[i];
      const card=document.createElement("div"); card.className="forecast-card";
      const date=new Date(f.dt*1000);
      card.innerHTML=`
        <p>${date.toLocaleDateString(undefined,{weekday:'short'})}</p>
        <img src="http://openweathermap.org/img/wn/${f.weather[0].icon}@2x.png" />
        <p>${f.main.temp.toFixed(1)}¬∞C</p>
        <p>${f.weather[0].main}</p>`;
      forecastDiv.appendChild(card);
    }
    container.appendChild(forecastDiv);

    textInput.value="";

  } catch(e){
    console.log(e);
    container.style.display="block";
    container.innerHTML=`<p class="error">Something went wrong!</p>`;
  }
}

function formatTime(date){
  let h=date.getUTCHours(), m=date.getUTCMinutes(), ampm=h>=12?"PM":"AM";
  h=h%12; if(h===0) h=12;
  return `${h}:${m.toString().padStart(2,'0')} ${ampm}`;
}

// Event Listeners
searchBtn.addEventListener("click",()=>fetchWeather(textInput.value));
textInput.addEventListener("keypress",(e)=>{ if(e.key==="Enter") fetchWeather(textInput.value); });

// Dark/Light Theme Toggle
themeToggle.addEventListener("click",()=>{
  darkMode=!darkMode;
  document.body.classList.toggle("dark-mode");
  themeToggle.innerText=darkMode?"‚òÄÔ∏è":"üåô";
});
</script>
</body>
</html>
